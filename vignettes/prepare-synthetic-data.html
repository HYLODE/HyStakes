<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>HyStakes – prepare-synthetic-data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">HyStakes</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../vignettes/vignettes.html">Vignettes</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">About</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/HYLODE/HyStakes"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">(Untitled)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">ICU discharges</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tutorial/bayes-for-discharge.html" class="sidebar-item-text sidebar-link">Predicting discharge using Bayesian statistics</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prepare-synthetic-data" id="toc-prepare-synthetic-data" class="nav-link active" data-scroll-target="#prepare-synthetic-data">Prepare synthetic data</a>
  <ul class="collapse">
  <li><a href="#load-environment-variables" id="toc-load-environment-variables" class="nav-link" data-scroll-target="#load-environment-variables">Load environment variables</a></li>
  <li><a href="#prepare-the-live-query" id="toc-prepare-the-live-query" class="nav-link" data-scroll-target="#prepare-the-live-query">Prepare the ‘live’ query</a></li>
  <li><a href="#simulatefake-each-field" id="toc-simulatefake-each-field" class="nav-link" data-scroll-target="#simulatefake-each-field">Simulate/fake each field</a>
  <ul class="collapse">
  <li><a href="#hours-to-discharge" id="toc-hours-to-discharge" class="nav-link" data-scroll-target="#hours-to-discharge">Hours to discharge</a></li>
  <li><a href="#department" id="toc-department" class="nav-link" data-scroll-target="#department">Department</a></li>
  <li><a href="#age" id="toc-age" class="nav-link" data-scroll-target="#age">Age</a></li>
  <li><a href="#pulse" id="toc-pulse" class="nav-link" data-scroll-target="#pulse">Pulse</a></li>
  </ul></li>
  <li><a href="#prepare-dummy-data-frame" id="toc-prepare-dummy-data-frame" class="nav-link" data-scroll-target="#prepare-dummy-data-frame">Prepare dummy data frame</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.dev/hylode/hystakes/blob/main/hystakes/vignettes/prepare-synthetic-data.ipynb" class="toc-action">Edit this page</a></p><p><a href="https://github.com/hylode/hystakes/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="prepare-synthetic-data" class="level1">
<h1>Prepare synthetic data</h1>
<ul>
<li>Steve Harris</li>
<li>2022-09-11</li>
</ul>
<p>We need synthetic data.<br>
We will inspect live data in this notebook, and then derive a short script that will generate suitable dummy data.</p>
<p><strong>NOTE</strong></p>
<p>This notebook will be be run manually.<br>
That should happen from the <em>project root directory</em> where the <code>readme.md</code> and the <code>.env</code> file are stored.</p>
<p>The following changes to the project root assuming that the notebook kernel is normally starting from the same directory as the notebook itself.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:36:58.980387Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:36:58.979672Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:36:58.992199Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:36:58.991141Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:36:58.980313Z&quot;}" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd ..<span class="op">/</span>..</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>/data/hymind/home/steve/HyStakes</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:36:58.995461Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:36:58.995084Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:01.107025Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:01.106152Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:36:58.995432Z&quot;}" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> poisson, lognorm</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sqlalchemy <span class="im">as</span> sa</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:01.111585Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:01.111291Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:01.129827Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:01.128798Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:01.111556Z&quot;}" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="load-environment-variables" class="level2">
<h2 class="anchored" data-anchor-id="load-environment-variables">Load environment variables</h2>
<p>Load environment variables and set-up SQLAlchemy connection engine for the EMAP Star</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:01.131202Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:01.130899Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:01.138461Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:01.137172Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:01.131173Z&quot;}" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>load_dotenv(dotenv_path<span class="op">=</span><span class="st">".env"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">assert</span> os.getenv(<span class="st">"DOTENV_FILE_EXISTS"</span>) <span class="op">==</span> <span class="st">'TRUE'</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> <span class="pp">AssertionError</span>:</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"!!! ERROR: check that the .env file exists at the top level of the project"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"!!! ERROR: check that the relative path is correct"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:01.140900Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:01.140230Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:01.294023Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:01.285023Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:01.140851Z&quot;}" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the PostgreSQL connection</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>uds_host <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_HOST'</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>uds_name <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_NAME'</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>uds_port <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_PORT'</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>uds_user <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_USER'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>uds_passwd <span class="op">=</span> os.getenv(<span class="st">'EMAP_DB_PASSWORD'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>emapdb_engine <span class="op">=</span> sa.create_engine(<span class="ss">f'postgresql://</span><span class="sc">{</span>uds_user<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>uds_passwd<span class="sc">}</span><span class="ss">@</span><span class="sc">{</span>uds_host<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>uds_port<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>uds_name<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-the-live-query" class="level2">
<h2 class="anchored" data-anchor-id="prepare-the-live-query">Prepare the ‘live’ query</h2>
<p>Here’s the <em>very</em> long query that I built.<br>
It selects all patients on tower wards 2 weeks ago (336 hours), and then finds the age (rounded) and the last heart rate. The remaining data has <em>no</em> identifiers.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a> <span class="kw">left</span>(md5(lv.hospital_visit_id:<span class="ch">:TEXT</span>), <span class="dv">6</span>) <span class="kw">id</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">--,lv.location_visit_id</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">--,lv.admission_datetime admit_dt_bed</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">--,lv.discharge_datetime disch_dt_bed</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">--,hv.admission_datetime admit_dt_hosp</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">--,hv.discharge_datetime disch_dt_hosp</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>,<span class="fu">ROUND</span>(<span class="fu">EXTRACT</span>(epoch <span class="kw">FROM</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    (hv.discharge_datetime <span class="op">-</span> (NOW() <span class="op">-</span> <span class="st">'336 HOURS'</span>:<span class="ch">:INTERVAL</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    ))<span class="op">/</span><span class="dv">3600</span>) hours_to_discharge</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">--,hv.discharge_destination</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">--,hv.patient_class</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">--,lo.location_string</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>,dept.name department</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- include age rounded to 5</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>, <span class="fu">ROUND</span>(DATE_PART(<span class="st">'year'</span>,AGE(cd.date_of_birth ))<span class="op">/</span><span class="dv">5</span>) <span class="op">*</span> <span class="dv">5</span> AGE</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co">-- add last heart rate</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>,hr.value_as_real pulse</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="co">--,hr.observation_datetime</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> star.location_visit lv</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> star.location lo <span class="kw">ON</span> lv.location_id <span class="op">=</span> lo.location_id</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> star.department dept <span class="kw">ON</span> lo.department_id <span class="op">=</span> dept.department_id </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> star.hospital_visit hv <span class="kw">ON</span> lv.hospital_visit_id <span class="op">=</span> hv.hospital_visit_id</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> star.core_demographic cd <span class="kw">ON</span> hv.mrn_id <span class="op">=</span> cd.mrn_id</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> (</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WITH</span> obs <span class="kw">AS</span> (</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>         vo.visit_observation_id</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        ,vo.hospital_visit_id</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        ,vo.observation_datetime</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        ,vo.value_as_real</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>        ,ot.name</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> star.visit_observation vo</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>        <span class="kw">LEFT</span> <span class="kw">JOIN</span> star.visit_observation_type ot <span class="kw">ON</span> vo.visit_observation_type_id <span class="op">=</span> ot.visit_observation_type_id</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>        <span class="kw">WHERE</span> </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        ot.id_in_application <span class="op">=</span> <span class="st">'8'</span> <span class="co">-- heart rate</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        vo.observation_datetime <span class="op">&lt;</span> NOW() <span class="op">-</span> <span class="st">'336 HOURS'</span>:<span class="ch">:INTERVAL</span> </span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>        vo.observation_datetime <span class="op">&gt;</span> NOW() <span class="op">-</span> <span class="st">'360 HOURS'</span>:<span class="ch">:INTERVAL</span> </span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    obs_tail <span class="kw">AS</span> (</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">SELECT</span> </span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>         obs.<span class="op">*</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>        ,<span class="fu">row_number</span>() <span class="kw">over</span> (<span class="kw">partition</span> <span class="kw">BY</span> obs.hospital_visit_id <span class="kw">ORDER</span> <span class="kw">BY</span> obs.observation_datetime <span class="kw">DESC</span>) obs_tail</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>        <span class="kw">FROM</span> obs</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>    <span class="kw">SELECT</span> </span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>     visit_observation_id</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>    ,hospital_visit_id</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    ,observation_datetime</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>    ,value_as_real</span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    ,NAME</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> obs_tail </span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> obs_tail <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>) hr <span class="co">-- heart rate</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a><span class="kw">ON</span> lv.hospital_visit_id <span class="op">=</span> hr.hospital_visit_id</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> </span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>dept.name <span class="kw">IN</span> (</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a><span class="st">'UCH T03 INTENSIVE CARE'</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH SDEC'</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T01 ACUTE MEDICAL'</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T01 ENHANCED CARE'</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T06 HEAD (T06H)'</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T06 CENTRAL (T06C)'</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T06 SOUTH PACU'</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T06 GYNAE (T06G)'</span></span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T07 NORTH (T07N)'</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T07 CV SURGE'</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T07 SOUTH'</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T07 SOUTH (T07S)'</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T07 HDRU'</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T08 NORTH (T08N)'</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T08 SOUTH (T08S)'</span></span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T08S ARCU'</span></span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T09 SOUTH (T09S)'</span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T09 NORTH (T09N)'</span></span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T09 CENTRAL (T09C)'</span></span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T10 SOUTH (T10S)'</span></span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T10 NORTH (T10N)'</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T10 MED (T10M)'</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T11 SOUTH (T11S)'</span></span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T11 NORTH (T11N)'</span></span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T11 EAST (T11E)'</span></span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T11 NORTH (T11NO)'</span></span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T12 SOUTH (T12S)'</span></span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T12 NORTH (T12N)'</span></span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T13 SOUTH (T13S)'</span></span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T13 NORTH ONCOLOGY'</span></span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T13 NORTH (T13N)'</span></span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T14 NORTH TRAUMA'</span></span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T14 NORTH (T14N)'</span></span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T14 SOUTH ASU'</span></span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T14 SOUTH (T14S)'</span></span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T15 SOUTH DECANT'</span></span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T15 SOUTH (T15S)'</span></span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T15 NORTH (T15N)'</span></span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T15 NORTH DECANT'</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T16 NORTH (T16N)'</span></span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T16 SOUTH (T16S)'</span></span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>,<span class="st">'UCH T16 SOUTH WINTER'</span></span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span></span>
<span id="cb7-113"><a href="#cb7-113" aria-hidden="true" tabindex="-1"></a>lv.admission_datetime <span class="op">&lt;</span> NOW() <span class="op">-</span> <span class="st">'336 HOURS'</span>:<span class="ch">:INTERVAL</span> </span>
<span id="cb7-114"><a href="#cb7-114" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span></span>
<span id="cb7-115"><a href="#cb7-115" aria-hidden="true" tabindex="-1"></a>    (lv.discharge_datetime <span class="op">&gt;</span> NOW() <span class="op">-</span> <span class="st">'336 HOURS'</span>:<span class="ch">:INTERVAL</span> </span>
<span id="cb7-116"><a href="#cb7-116" aria-hidden="true" tabindex="-1"></a>     <span class="kw">OR</span></span>
<span id="cb7-117"><a href="#cb7-117" aria-hidden="true" tabindex="-1"></a>      (lv.discharge_datetime <span class="kw">IS</span> <span class="kw">NULL</span> <span class="kw">AND</span> hv.discharge_datetime <span class="kw">IS</span> <span class="kw">NULL</span>)</span>
<span id="cb7-118"><a href="#cb7-118" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-119"><a href="#cb7-119" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> </span>
<span id="cb7-120"><a href="#cb7-120" aria-hidden="true" tabindex="-1"></a>lo.location_string <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'%WAIT%'</span></span>
<span id="cb7-121"><a href="#cb7-121" aria-hidden="true" tabindex="-1"></a><span class="kw">AND</span> </span>
<span id="cb7-122"><a href="#cb7-122" aria-hidden="true" tabindex="-1"></a>lo.location_string <span class="kw">NOT</span> <span class="kw">LIKE</span> <span class="st">'%null%'</span></span>
<span id="cb7-123"><a href="#cb7-123" aria-hidden="true" tabindex="-1"></a>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To benefit from syntax highlighting, proper version control and other goodness then we’ll actually load the query from its own file. The list above is there just to improve the flow and readability of this notebook.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:01.298191Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:01.297825Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:01.304687Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:01.302464Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:01.298161Z&quot;}" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> Path(<span class="st">'utils/queries/discharges_dummy.sql'</span>).read_text()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># this handles escaping etc (e.g. % in the LIKE clause becomes %%)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> sa.text(q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:01.306344Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:01.306042Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.104060Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.103011Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:01.306315Z&quot;}" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(q, emapdb_engine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now inspect the fields</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.105967Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.105623Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.123753Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.122731Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.105933Z&quot;}" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 444 entries, 0 to 443
Data columns (total 5 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   id                  444 non-null    object 
 1   hours_to_discharge  263 non-null    float64
 2   department          444 non-null    object 
 3   age                 444 non-null    float64
 4   pulse               381 non-null    float64
dtypes: float64(3), object(2)
memory usage: 17.5+ KB</code></pre>
</div>
</div>
</section>
<section id="simulatefake-each-field" class="level2">
<h2 class="anchored" data-anchor-id="simulatefake-each-field">Simulate/fake each field</h2>
<section id="hours-to-discharge" class="level3">
<h3 class="anchored" data-anchor-id="hours-to-discharge">Hours to discharge</h3>
<p>Plot the distribution, then pick a distribution and create a simple sample</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.125737Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.125167Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.146807Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.145823Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.125608Z&quot;}" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>LoS <span class="op">=</span> df[<span class="st">'hours_to_discharge'</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>LoS.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>count    263.000000
mean     108.049430
std       82.814341
min        1.000000
25%       43.000000
50%       86.000000
75%      157.500000
max      332.000000
Name: hours_to_discharge, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.148498Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.148017Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.367250Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.366219Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.148468Z&quot;}" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> plt.hist(LoS, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now generate an empirical distribution that roughly matches as above by sampling with replacement</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.368981Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.368645Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.380851Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.379743Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.368949Z&quot;}" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>LoS_sample <span class="op">=</span> LoS.sample(frac<span class="op">=</span><span class="dv">1</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>LoS_sample.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>count    263.000000
mean      96.634981
std       80.698500
min        1.000000
25%       40.000000
50%       68.000000
75%      138.500000
max      305.000000
Name: hours_to_discharge, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.382588Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.381769Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.586995Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.586052Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.382555Z&quot;}" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> plt.hist(LoS_sample, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-13-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="department" class="level3">
<h3 class="anchored" data-anchor-id="department">Department</h3>
<p>Plot the distribution, then pick a distribution and create a simple sample</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.588259Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.587948Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.598017Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.596673Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.588229Z&quot;}" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>department <span class="op">=</span> df[<span class="st">'department'</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>department.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>UCH T01 ACUTE MEDICAL     36
UCH T10 SOUTH (T10S)      35
UCH T10 NORTH (T10N)      24
UCH T09 NORTH (T09N)      24
UCH T13 NORTH ONCOLOGY    24
UCH SDEC                  23
UCH T13 SOUTH (T13S)      22
UCH T08 SOUTH (T08S)      21
UCH T08 NORTH (T08N)      20
UCH T09 CENTRAL (T09C)    19
UCH T03 INTENSIVE CARE    19
UCH T12 NORTH (T12N)      18
UCH T14 NORTH TRAUMA      17
UCH T16 NORTH (T16N)      15
UCH T07 NORTH (T07N)      15
UCH T16 SOUTH WINTER      14
UCH T14 SOUTH ASU         13
UCH T06 HEAD (T06H)       12
UCH T12 SOUTH (T12S)      10
UCH T11 NORTH (T11N)       9
UCH T01 ENHANCED CARE      9
UCH T11 SOUTH (T11S)       9
UCH T07 SOUTH              7
UCH T06 CENTRAL (T06C)     6
UCH T14 NORTH (T14N)       4
UCH T06 SOUTH PACU         4
UCH T09 SOUTH (T09S)       3
UCH T06 GYNAE (T06G)       3
UCH T15 SOUTH (T15S)       2
UCH T07 SOUTH (T07S)       2
UCH T10 MED (T10M)         1
UCH T08S ARCU              1
UCH T15 NORTH (T15N)       1
UCH T11 EAST (T11E)        1
UCH T16 SOUTH (T16S)       1
Name: department, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.600030Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.599325Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:03.606337Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:03.605183Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.599998Z&quot;}" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.groupby(<span class="st">'department'</span>)[<span class="st">'department'</span>].count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:03.608642Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:03.607670Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.028092Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.027086Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:03.608611Z&quot;}" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="fl">1.5</span><span class="op">*</span><span class="dv">72</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ax.bar(X.index, X.values)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now generate an empirical distribution that roughly matches as above by sampling with replacement</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.029333Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.029027Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.038957Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.038082Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.029303Z&quot;}" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>department_sample <span class="op">=</span>department.sample(frac<span class="op">=</span><span class="dv">1</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>department_sample.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>UCH T01 ACUTE MEDICAL     45
UCH T10 SOUTH (T10S)      37
UCH T09 CENTRAL (T09C)    30
UCH T13 NORTH ONCOLOGY    26
UCH T10 NORTH (T10N)      26
UCH T09 NORTH (T09N)      25
UCH T13 SOUTH (T13S)      23
UCH T03 INTENSIVE CARE    22
UCH SDEC                  22
UCH T07 NORTH (T07N)      21
UCH T06 HEAD (T06H)       16
UCH T12 NORTH (T12N)      16
UCH T16 NORTH (T16N)      16
UCH T14 SOUTH ASU         14
UCH T08 SOUTH (T08S)      14
UCH T14 NORTH TRAUMA      12
UCH T16 SOUTH WINTER      12
UCH T08 NORTH (T08N)      11
UCH T11 NORTH (T11N)      10
UCH T11 SOUTH (T11S)       7
UCH T01 ENHANCED CARE      6
UCH T07 SOUTH              6
UCH T12 SOUTH (T12S)       5
UCH T06 SOUTH PACU         5
UCH T14 NORTH (T14N)       3
UCH T06 CENTRAL (T06C)     3
UCH T06 GYNAE (T06G)       3
UCH T15 SOUTH (T15S)       3
UCH T07 SOUTH (T07S)       1
UCH T15 NORTH (T15N)       1
UCH T16 SOUTH (T16S)       1
UCH T10 MED (T10M)         1
UCH T09 SOUTH (T09S)       1
Name: department, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.040854Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.040339Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.431584Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.430573Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.040822Z&quot;}" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>X_s <span class="op">=</span> department_sample.value_counts()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>X_s <span class="op">=</span> X_s.reindex(X.index)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(dpi<span class="op">=</span><span class="fl">1.5</span><span class="op">*</span><span class="dv">72</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>ax.bar(X_s.index, X_s.values)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>ax.tick_params(axis<span class="op">=</span><span class="st">'x'</span>, rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="age" class="level3">
<h3 class="anchored" data-anchor-id="age">Age</h3>
<p>Plot the distribution, then pick a distribution and create a simple sample</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.433229Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.432925Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.443985Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.442851Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.433199Z&quot;}" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>age <span class="op">=</span> df[<span class="st">'age'</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>age.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>count    444.000000
mean      57.927928
std       23.748289
min        0.000000
25%       40.000000
50%       65.000000
75%       75.000000
max      100.000000
Name: age, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.445803Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.444840Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.627006Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.625983Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.445773Z&quot;}" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> plt.hist(age, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now generate an empirical distribution that roughly matches as above by sampling with replacement</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.629369Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.628516Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.639886Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.638951Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.629333Z&quot;}" data-tags="[]" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>age_sample <span class="op">=</span> age.sample(frac<span class="op">=</span><span class="dv">1</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>age_sample.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>count    444.000000
mean      58.355856
std       22.933793
min        5.000000
25%       43.750000
50%       65.000000
75%       75.000000
max      100.000000
Name: age, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.644501Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.644187Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.843016Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.841950Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.644472Z&quot;}" data-tags="[]" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> plt.hist(age_sample, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-22-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="pulse" class="level3">
<h3 class="anchored" data-anchor-id="pulse">Pulse</h3>
<p>Plot the distribution, then pick a distribution and create a simple sample</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.844821Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.844348Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:04.855868Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:04.854929Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.844788Z&quot;}" data-tags="[]" data-execution_count="22">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>pulse <span class="op">=</span> df[<span class="st">'pulse'</span>]</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>pulse.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>count    381.000000
mean      81.391076
std       17.147712
min       42.000000
25%       70.000000
50%       80.000000
75%       90.000000
max      187.000000
Name: pulse, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:04.857712Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:04.857076Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:05.073867Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:05.072931Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:04.857681Z&quot;}" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> plt.hist(pulse, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Now generate an empirical distribution that roughly matches as above by sampling with replacement</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:05.075647Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:05.075219Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:05.087954Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:05.086696Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:05.075606Z&quot;}" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pulse_sample <span class="op">=</span> pulse.sample(frac<span class="op">=</span><span class="dv">1</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pulse_sample.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>count    375.000000
mean      79.696000
std       15.435336
min       46.000000
25%       68.500000
50%       78.000000
75%       89.000000
max      133.000000
Name: pulse, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:37:05.090032Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:37:05.089139Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:37:05.274742Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:37:05.273497Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:37:05.089998Z&quot;}" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>n, bins, patches <span class="op">=</span> plt.hist(pulse_sample, bins<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="prepare-synthetic-data_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:38:08.972222Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:38:08.971696Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:38:08.980757Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:38:08.979618Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:38:08.972190Z&quot;}" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>pulse_sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>115     59.0
363    102.0
317     72.0
257     60.0
265      NaN
       ...  
237      NaN
118     87.0
47      78.0
253     63.0
394     77.0
Name: pulse, Length: 444, dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="prepare-dummy-data-frame" class="level2">
<h2 class="anchored" data-anchor-id="prepare-dummy-data-frame">Prepare dummy data frame</h2>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:44:25.174714Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:44:25.174029Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:44:25.179846Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:44:25.179151Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:44:25.174681Z&quot;}" data-tags="[]" data-execution_count="44">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>LoS_sample.reset_index(inplace<span class="op">=</span><span class="va">True</span>, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>department_sample.reset_index(inplace<span class="op">=</span><span class="va">True</span>, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>age_sample.reset_index(inplace<span class="op">=</span><span class="va">True</span>, drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>pulse_sample.reset_index(inplace<span class="op">=</span><span class="va">True</span>, drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:44:25.742662Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:44:25.742148Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:44:25.750197Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:44:25.749206Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:44:25.742629Z&quot;}" data-tags="[]" data-execution_count="45">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>df_dummy <span class="op">=</span> pd.concat([LoS_sample, department_sample, age_sample, pulse_sample], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:45:38.586478Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:45:38.585512Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:45:38.592421Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:45:38.591015Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:45:38.586445Z&quot;}" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df_dummy.reset_index(inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:47:07.474397Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:47:07.473854Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:47:07.480094Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:47:07.479229Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:47:07.474363Z&quot;}" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_dummy.rename({<span class="st">'index'</span>: <span class="st">'id'</span>}, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:47:08.043036Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:47:08.042642Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:47:08.057182Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:47:08.055700Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:47:08.043003Z&quot;}" data-tags="[]" data-execution_count="52">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>df_dummy.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>hours_to_discharge</th>
      <th>department</th>
      <th>age</th>
      <th>pulse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>42.0</td>
      <td>UCH T11 NORTH (T11N)</td>
      <td>60.0</td>
      <td>59.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>NaN</td>
      <td>UCH T03 INTENSIVE CARE</td>
      <td>65.0</td>
      <td>102.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>132.0</td>
      <td>UCH T13 NORTH ONCOLOGY</td>
      <td>60.0</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>206.0</td>
      <td>UCH T01 ACUTE MEDICAL</td>
      <td>10.0</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>90.0</td>
      <td>UCH T11 SOUTH (T11S)</td>
      <td>65.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Write dummy data out. Use sqlite to manage typing etc.</p>
<div class="cell" data-execution="{&quot;iopub.execute_input&quot;:&quot;2022-09-11T22:53:09.508470Z&quot;,&quot;iopub.status.busy&quot;:&quot;2022-09-11T22:53:09.507276Z&quot;,&quot;iopub.status.idle&quot;:&quot;2022-09-11T22:53:09.545485Z&quot;,&quot;shell.execute_reply&quot;:&quot;2022-09-11T22:53:09.544609Z&quot;,&quot;shell.execute_reply.started&quot;:&quot;2022-09-11T22:53:09.508432Z&quot;}" data-tags="[]" data-execution_count="57">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sqlite_engine <span class="op">=</span> sa.create_engine(<span class="st">'sqlite:///data/dummy.db'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df_dummy.to_sql(<span class="st">'discharges'</span>, con<span class="op">=</span>sqlite_engine, if_exists<span class="op">=</span><span class="st">'replace'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now demonstrate that you can use those data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remember `///` for sqlite file paths</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>engine <span class="op">=</span> sa.create_engine(<span class="st">'sqlite:///../../data/dummy.db'</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql(<span class="st">'select * from discharges'</span>, engine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>